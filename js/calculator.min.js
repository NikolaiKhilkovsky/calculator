/**
 * Simple calculator script
 *
 * @author Nikolai Khilkovsky
 * @author khilkovn@gmail.com
 *
 * @requires react.js
 */

var historyData=[];var CalcBox=React.createClass({displayName:"CalcBox",updateResult:function(b){var e=this.state.historyData;var d=this.state.result;var c;if(/\s=\s\-?[0-9]+\.?[0-9]*$/.test(d)&&/[0-9]+|\./.test(b)){d=""}switch(b){case"C":this.setState({result:this.props.result});return;case"-":case"+":case"=":d=d==""?"0":d.replace(/(\.|\s\+\s|\s\-\s)$/,"");if(b=="="&&(!/(\s\+\s|\s\-\s).*[0-9]+$/.test(d)||/\s=\s\-?[0-9]+\.?[0-9]*$/.test(d))){c=""}else{if(b=="-"&&d=="0"){d="";c=b}else{if((b=="-"||b=="+")&&/\s=\s\-?[0-9]+\.?[0-9]*$/.test(d)){d=d.replace(/^.+=\s/,"");c=" "+b+" "}else{c=" "+b+" "}}}break;case"0":c=d==""?"0":b;c=d=="0"?"":b;break;case"00":if(d=="0"){c=""}else{c=d==""?"0":b}break;case".":if(d==""||/\s$/.test(d)){c="0"+b}else{if(/\.[0-9]*$/.test(d)){c=""}else{c=b}}break;default:c=b}if(c==""){return}d+=c;if(b=="="){d+=calculate(d.split(" "));e.push(d);this.setState({historyData:e})}this.setState({result:d})},getInitialState:function(){return{result:this.props.result,historyData:this.props.historyData}},render:function(){return(React.createElement("div",{className:"calcBox"},React.createElement("h1",null,"The Simple Calculator"),React.createElement("div",{className:"row"},React.createElement(CalcBody,{result:this.state.result,onButtonClick:this.updateResult}),React.createElement(CalcHistory,{data:this.state.historyData}))))}});var CalcBody=React.createClass({displayName:"CalcBody",getInitialState:function(){return{buttonsList:["7","8","9","C","4","5","6","-","1","2","3","+","0","00",".","="]}},handleClick:function(b){this.props.onButtonClick(b)},render:function(){var a=this.state.buttonsList.map(function(b){return React.createElement("button",{className:"calcButton",onClick:this.handleClick.bind(null,b)},b)}.bind(this));return(React.createElement("div",{className:"calcBody"},React.createElement("div",{className:"showResult"},React.createElement("input",{type:"text",placeholder:"0",value:this.props.result,readOnly:true})),React.createElement("div",{className:"buttons"},a)))}});var CalcHistory=React.createClass({displayName:"CalcHistory",render:function(){var a=this.props.data.map(function(b){return(React.createElement("div",{className:"item"},b))});return(React.createElement("div",{className:"calcHistory"},React.createElement("h3",null,"Calculator history"),a))}});React.render(React.createElement(CalcBox,{historyData:historyData,result:""}),document.getElementById("calculator"));function calculate(c){var b,a,d;while(c.length>2){a=c[0].split(".");d=c[2].split(".");if(a[1]&&d[1]){a[1]=""+a[1];d[1]=""+d[1];b=Math.pow(10,a[1].length>d[1].length?a[1].length:d[1].length)}else{if(a[1]){a[1]=""+a[1];b=Math.pow(10,a[1].length)}else{if(d[1]){d[1]=""+d[1];b=Math.pow(10,d[1].length)}else{b=1}}}switch(c[1]){case"+":c[0]=""+(parseFloat(c[0])*b+parseFloat(c[2])*b)/b;break;case"-":c[0]=""+(parseFloat(c[0])*b-parseFloat(c[2])*b)/b;break}c.splice(1,2)}return c[0].toString()};
